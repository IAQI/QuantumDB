{% extends "base.html" %}

{% block title %}Conferences - QuantumDB{% endblock %}

{% block content %}
<article>
    <header>
        <h1>Conferences</h1>
        <p>Browse quantum computing conferences: QIP, QCrypt, and TQC</p>
    </header>

    <section class="venue-filters">
        <div class="filter-buttons">
            <button type="button" 
                    class="venue-toggle active" 
                    data-venue="QIP"
                    onclick="toggleVenue(this)">
                QIP
            </button>
            <button type="button" 
                    class="venue-toggle active" 
                    data-venue="QCRYPT"
                    onclick="toggleVenue(this)">
                QCrypt
            </button>
            <button type="button" 
                    class="venue-toggle active" 
                    data-venue="TQC"
                    onclick="toggleVenue(this)">
                TQC
            </button>
        </div>
    </section>

    <section id="conference-table">
        {% if conferences.is_empty() %}
        <p>No conferences found.</p>
        {% else %}
        <table id="conferences-list-table" class="sortable-table">
            <thead>
                <tr>
                    <th data-sort="conference">Conference</th>
                    <th data-sort="location">Location</th>
                    <th data-sort="date">Date</th>
                    <th data-sort="papers">Papers</th>
                    <th data-sort="committee">Committee</th>
                    <th data-sort="rate">Acceptance Rate</th>
                </tr>
            </thead>
            <tbody>
                {% for conf in conferences %}
                <tr>
                    <td data-value="conference"><a href="/conferences/{{ conf.slug }}" class="conference-link"><strong>{{ conf.venue }} {{ conf.year }}</strong></a></td>
                    <td data-value="location">{{ conf.location }}</td>
                    <td data-value="date">{{ conf.start_date }}</td>
                    <td data-value="papers">{{ conf.publication_count }}</td>
                    <td data-value="committee">{{ conf.committee_member_count }}</td>
                    <td data-value="rate">{% if !conf.acceptance_rate.is_empty() %}{{ conf.acceptance_rate }}{% else %}-{% endif %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}
    </section>
</article>

<script>
function toggleVenue(button) {
    button.classList.toggle('active');
    updateConferences();
}

function updateConferences() {
    const activeVenues = Array.from(document.querySelectorAll('.venue-toggle.active'))
        .map(btn => btn.dataset.venue);
    
    const venueParam = activeVenues.length > 0 ? activeVenues.join(',') : '';
    const url = `/conferences?venues=${encodeURIComponent(venueParam)}`;
    
    htmx.ajax('GET', url, {
        target: '#conference-table',
        swap: 'innerHTML'
    });
}

// Load initial data on page load
document.addEventListener('DOMContentLoaded', function() {
    updateConferences();
});
</script>

{% endblock %}
