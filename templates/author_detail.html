{% extends "base.html" %}

{% block title %}{{ author.full_name }} - QuantumDB{% endblock %}

{% block content %}
<article>
    <header>
        <h1>{{ author.full_name }}</h1>
        {% if !author.affiliation.is_empty() %}
        <p><strong>Affiliation:</strong> {{ author.affiliation }}</p>
        {% endif %}
        <nav>
            <ul>
                {% if !author.orcid.is_empty() %}
                <li><a href="https://orcid.org/{{ author.orcid }}" target="_blank">ORCID</a></li>
                {% endif %}
                {% if !author.homepage_url.is_empty() %}
                <li><a href="{{ author.homepage_url }}" target="_blank">Homepage</a></li>
                {% endif %}
            </ul>
        </nav>
    </header>

    <section class="stats-grid">
        <div class="stat-card clickable" onclick="scrollToHighlight('#talks-section', 'all')">
            <div class="stat-value">{{ author.publication_count }}</div>
            <div class="stat-label">Talks</div>
        </div>
        <div class="stat-card clickable" onclick="scrollToHighlight('#committee-section', 'all')">
            <div class="stat-value">{{ author.committee_role_count }}</div>
            <div class="stat-label">Committee Roles</div>
        </div>
        <div class="stat-card clickable" onclick="scrollToHighlight('#committee-section', 'leadership')">
            <div class="stat-value">{{ author.leadership_count }}</div>
            <div class="stat-label">Leadership Roles</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{% if !author.first_year.is_empty() %}{{ author.first_year }}–{{ author.last_year }}{% else %}-{% endif %}</div>
            <div class="stat-label">Years Active</div>
        </div>
    </section>

    {% if !author.venues.is_empty() %}
    <section>
        <p><strong>Venues:</strong> {{ author.venues }}</p>
    </section>
    {% endif %}

    {% if !publications.is_empty() %}
    <section id="talks-section">
        <h2>Talks</h2>
        <table id="publications-table" class="sortable-table">
            <thead>
                <tr>
                    <th data-sort="title">Title</th>
                    <th data-sort="conference">Conference</th>
                    <th data-sort="type">Type</th>
                    <th data-sort="coauthors">Co-authors</th>
                </tr>
            </thead>
            <tbody>
                {% for pub in publications %}
                <tr>
                    <td data-value="title">
                        {% if !pub.arxiv_ids.is_empty() %}
                            <a href="https://arxiv.org/abs/{{ pub.arxiv_ids[0] }}" target="_blank" rel="noopener noreferrer">{{ pub.title }} ↗</a>
                        {% else %}
                            {{ pub.title }}
                        {% endif %}
                    </td>
                    <td data-value="conference"><a href="/conferences/{{ pub.conference_slug }}" class="conference-link">{{ pub.conference_venue }} {{ pub.conference_year }}</a></td>
                    <td data-value="type">{{ pub.paper_type }}</td>
                    <td data-value="coauthors">{% if !pub.coauthors.is_empty() %}{{ pub.coauthors }}{% else %}-{% endif %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>
    {% endif %}

    {% if !committee_roles.is_empty() %}
    <section id="committee-section">
        <h2>Committee Service</h2>
        <table id="committee-table" class="sortable-table">
            <thead>
                <tr>
                    <th data-sort="conference">Conference</th>
                    <th data-sort="committee">Committee</th>
                    <th data-sort="position">Position</th>
                    <th data-sort="title">Title</th>
                </tr>
            </thead>
            <tbody>
                {% for role in committee_roles %}
                <tr>
                    <td data-value="conference"><a href="/conferences/{{ role.conference_slug }}" class="conference-link">{{ role.conference_venue }} {{ role.conference_year }}</a></td>
                    <td data-value="committee">{{ role.committee_type }}</td>
                    <td data-value="position" data-filter="position">{{ role.position }}</td>
                    <td data-value="title">{% if !role.role_title.is_empty() %}{{ role.role_title }}{% else %}-{% endif %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>
    {% endif %}

    {% if !coauthors.is_empty() %}
    <section>
        <h2>Collaborators</h2>
        <table id="collaborators-table" class="sortable-table">
            <thead>
                <tr>
                    <th data-sort="name">Co-author</th>
                    <th data-sort="count">Joint Talks</th>
                </tr>
            </thead>
            <tbody>
                {% for coauthor in coauthors %}
                <tr>
                    <td data-value="name"><a href="/authors/{{ coauthor.coauthor_id }}" class="author-link">{{ coauthor.coauthor_name }}</a></td>
                    <td data-value="count">{{ coauthor.collaboration_count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>
    {% endif %}
</article>
{% endblock %}
